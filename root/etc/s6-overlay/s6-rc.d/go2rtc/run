#!/usr/bin/with-contenv bashio
set -e
bashio::log.info "Starting go2rtc"

if [ ! -d /config/eufyp2p ]; then
    bashio::log.info "Copying default go2rtc.yaml to /config/eufyp2p/go2rtc.yaml"
    mkdir /config/eufyp2p
    cp config/go2rtc.yaml /config/eufyp2p/
else
    bashio::log.info "Using existing go2rtc.yaml in /config/eufyp2p/"
fi

#launching with tini to keep go2rtc the same
/usr/bin/tini -s -v -- "/usr/local/bin/go2rtc -config /config/eufyp2p/go2rtc.yaml"